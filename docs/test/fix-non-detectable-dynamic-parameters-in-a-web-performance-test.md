---
title: Napraw parametry dynamiczne, które nie są wykrywalne (test wydajności sieci Web)
description: Dowiedz się, jak Rejestrator testów wydajności sieci Web i aparat odtwarzania automatycznie obsługują najczęściej używane typy parametrów dynamicznych.
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- walkthroughs, load tests
- load tests, walkthroughs
- load tests, correlating dynamic parameters
ms.assetid: 92dff25c-36ee-4135-acdd-315c4962fa11
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 5d1e1c35feba87ada3b98d13c5d43c436fd91b1d
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 02/08/2021
ms.locfileid: "99936564"
---
# <a name="fix-non-detectable-dynamic-parameters-in-a-web-performance-test"></a>Naprawa niewykrywalnych parametrów dynamicznych w teście wydajności sieci Web

Niektóre witryny sieci Web używają parametrów dynamicznych do przetwarzania niektórych swoich żądań internetowych. Parametr dynamiczny to parametr, którego wartość jest ponownie generowana za każdym razem, gdy użytkownik uruchamia aplikację. Przykładem parametru dynamicznego jest identyfikator sesji. Identyfikator sesji zwykle zmienia się co 5 – 30 minut. Rejestrator testów wydajności sieci Web i aparat odtwarzania automatycznie obsługuje najczęściej spotykane typy parametrów dynamicznych:

- Wartości parametrów dynamicznych ustawione w wartości pliku cookie. Aparat testów wydajności sieci Web automatycznie obsługuje te podczas odtwarzania.

- Dynamiczne wartości parametrów, które są ustawiane w ukrytych polach na stronach HTML, takich jak stan widoku ASP.NET. Są one automatycznie obsługiwane przez rejestrator, który dodaje do testu reguły wyodrębniania pól ukrytych.

- Dynamiczne wartości parametrów, które są ustawiane jako ciąg zapytania lub parametry post formularza. Są one obsługiwane za pomocą wykrywania parametrów dynamicznych po zarejestrowaniu testu wydajności sieci Web.

Niektóre typy parametrów dynamicznych nie są wykrywane. Niewykrywany parametr dynamiczny spowoduje niepowodzenie testu wydajności sieci Web, ponieważ wartość dynamiczna będzie się różnić za każdym razem, gdy test zostanie uruchomiony. Aby prawidłowo obsłużyć te parametry, można ręcznie dodać reguły wyodrębniania do parametrów dynamicznych w testach wydajności sieci Web.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

## <a name="create-and-run-a-web-app-with-dynamic-parameters"></a>Tworzenie i uruchamianie aplikacji sieci Web z parametrami dynamicznymi

Aby przedstawić zarówno wykrywalny, jak i niewykrywalny parametr dynamiczny, utworzymy prostą aplikację sieci Web ASP.NET, która ma trzy formularze sieci Web z kilkoma kontrolkami i niestandardowym kodem. Następnie dowiesz się, jak izolować parametry dynamiczne i jak je obsłużyć.

1. Utwórz nowy projekt ASP.NET o nazwie **DynamicParameterSample**.

     ![Utwórz pusty projekt aplikacji sieci Web ASP.NET](../test/media/web_test_dynamicparameter_aspproject.png)

2. Dodaj formularz sieci Web o nazwie *QueryString. aspx*.

3. W widoku projektu przeciągnij HiddenField na stronę, a następnie w polu Zmień wartość właściwości (ID) na HiddenFieldSessionID.

     ![Dodaj HiddenField](../test/media/web_test_dynamicparameter_hiddenfield.png)

4. Przejdź do widoku źródła strony QueryString i Dodaj następujący wyróżniony kod ASP.NET i JavaScript użyty do wygenerowania parametrów dynamicznych identyfikatora sesji:

    ```html
    <head runat="server">
    <title>JavaScript dynamic property correlation sample</title><script type="text/javascript" language="javascript">    <!--        function jScriptQueryString()         {            var Hidden = document.getElementById("HiddenFieldSessionID");            var sessionId = Hidden.value;            window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;         }    //--></script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>
             <a name="QuerystringHyperlink" href="ASPQuery.aspx?CustomQueryString=ASPQueryString___<%= Session.SessionID %>">Dynamic querystring generated by ASP.net</a>         <br/>         <br/>         <a href="javascript:jScriptQueryString()">Dynamic querystring generated by javascript </a>
        </div>
        <asp:HiddenField ID="HiddenFieldSessionID" runat="server" />
        </form>
    </body>
    </html>
    ```

5. Otwórz plik *QueryString.aspx.cs* i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    public partial class Querystring : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            Session.Add("Key", "Value");HiddenFieldSessionID.Value = Session.SessionID;
        }
    }
    ```

6. Dodaj drugi formularz sieci Web o nazwie *ASPQuery. aspx*.

7. W widoku projektu przeciągnij **etykietę** na stronę i zmień wartość właściwości **(ID)** na **IndexLabel**.

     ![Dodawanie etykiety do formularza sieci Web](../test/media/web_test_dynamicparameter_label.png)

8. Przeciągnij **hiperlink** na stronę i zmień wartość dla jego właściwości **Text** na **spód**.

     ![Dodawanie hiperłącza do formularza sieci Web](../test/media/web_test_dynamicparameter_hyperlink.png)

9. Wybierz **(...)** dla właściwości **NavigationURL** .

     ![Edytuj Właściwość NavigateURL](../test/media/web_test_dynamicparameter_hyperlink_navurl.png)

     Wybierz pozycję *QueryString. aspx*.

     ![Wybierz adres URL, który ma być QueryString. aspx](../test/media/web_test_dynamicparameter_hyperlink_navurl2.png)

10. Otwórz plik *ASPQuery.aspx.cs* i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

11. Dodaj trzeci formularz sieci Web o nazwie *JScriptQuery. aspx*.

     Podobnie jak w przypadku drugiej strony, przeciągnij **etykietę** na formularz, ustawiając jej właściwość **(ID)** na **IndexLabel** , a następnie przeciągnij **hiperlink** do formularza, ustawiając jego właściwość **Text** na **spód**, a jej właściwość **NavigationURL** na **QueryString. aspx**.

     ![Dodawanie i Konfigurowanie trzeciego formularza sieci Web](../test/media/web_test_dynamicparameter_addwebform3.png)

12. Otwórz plik *JScriptQuery.aspx.cs* i Dodaj następujący wyróżniony kod do metody Page_Load:

    ```csharp
    protected void Page_Load(object sender, EventArgs e)
            {
                int index;            string qstring;            string dateportion;            string sessionidportion;            qstring = Request.QueryString["CustomQueryString"];            index = qstring.IndexOf("___");            dateportion = qstring.Substring(0, index);            index += 3;            sessionidportion = qstring.Substring(index, qstring.Length - index);            if (sessionidportion != Session.SessionID)            {                Response.StatusCode = 401;                IndexLabel.Text = "Failure!  Invalid querystring parameter found.";            }            else            {                IndexLabel.Text = "Success.  Dynamic querystring parameter was found.";            }            IndexLabel.Text += "<br>\r\n";
            }
    ```

13. Zapisz projekt.

14. W **Eksplorator rozwiązań** ustaw wartość *QueryString. aspx* jako stronę początkową.

     ![Ustaw stronę początkową w ciągu QueryString. aspx](../test/media/web_test_dynamicparameter_setstartpage.png)

15. Naciśnij klawisz **Ctrl** + **F5** , aby uruchomić aplikację sieci Web w przeglądarce. Skopiuj adres URL. Będzie on potrzebny podczas rejestrowania testu.

16. Wypróbuj oba linki. Każdy z nich powinien wyświetlać komunikat "powodzenie. Znaleziono dynamiczny parametr QueryString. "

     ![Uruchom aplikację internetową](../test/media/web_test_dynamicparameter_runapp.png)

     ![&#33; sukcesu](../test/media/web_test_dynamicparameter_runapp2.png)

## <a name="create-a-web-performance-test"></a>Utwórz test wydajności sieci Web

1. Dodaj projekt testu wydajności i obciążenia sieci Web do rozwiązania.

     ![Dodawanie projektu testowego Kategoria i obciążenia sieci Web](../test/media/web_test_dynamicparameter_addtestproject.png)

2. Zmień nazwę WebTest1. webtest na DynamicParameterSampleApp. webtest.

     ![Zmień nazwę testu wydajności sieci Web](../test/media/web_test_dynamicparameter_renametest.png)

3. Zarejestruj test.

     ![Rejestrowanie testu wydajności sieci Web](../test/media/web_test_dynamicparameter_recordtest.png)

4. Skopiuj i wklej adres URL z testowanej witryny sieci Web do przeglądarki.

     ![Wklej adres URL z testowanej witryny sieci Web](../test/media/web_test_dynamicparameter_recordtest2.png)

5. Przeglądaj aplikację sieci Web. Wybierz łącze ASP.NET, link do tyłu, a następnie łącze do kodu JavaScript, a następnie link wstecz.

     Rejestrator testu sieci Web Wyświetla żądania HTTP i adresy URL odpowiedzi podczas nawigowania po aplikacji sieci Web.

6. Wybierz przycisk **Zatrzymaj** w rejestratorze testu.

     Okno dialogowe wykrywania parametrów dynamicznych wyświetla pasek postępu, który pokazuje stan wykrywania parametrów w odpowiedziach HTTP, które zostały odebrane.

7. Parametr dynamiczny dla CustomQueryString na stronie ASPQuery jest wykrywany automatycznie. Niemniej jednak parametr dynamiczny dla CustomQueryString na stronie JScriptQuery nie zostanie wykryty.

     Wybierz **przycisk OK** , aby dodać regułę wyodrębniania do *QueryString. aspx*, powiązać ją ze stroną ASPQuery.

     ![Podnieś poziom wykrytego parametru dynamicznego](../test/media/web_test_dynamicparameter_promotedialog.png)

     Reguła wyodrębniania jest dodawana do pierwszego żądania *QueryString. aspx*.

     ![Reguła wyodrębniania dodana do żądania](../test/media/web_test_dynamicparameter_autoextractionrule.png)

     Rozwiń drugie żądanie w drzewie żądań dla *ASPQuery. aspx* i zwróć uwagę, że wartość CustomQueryString została powiązana z regułą wyodrębniania.

     ![CustomQueryString powiązano z regułą wyodrębniania](../test/media/web_test_dynamicparameter_autoextractionrule2.png)

8. Zapisz test.

## <a name="run-the-test-to-isolate-the-non-detected-dynamic-parameter"></a>Uruchom test, aby wyizolować wykryty parametr dynamiczny

1. Uruchom test.

     ![Uruchamianie testu wydajności sieci Web](../test/media/web_test_dynamicparameter_runtest.png)

2. Czwarte żądanie dotyczące strony *JScriptQuery. aspx* kończy się niepowodzeniem. Przejdź do testu sieci Web.

     ![Błąd parametru dynamicznego w wynikach testu](../test/media/web_test_dynamicparameter_runresults.png)

     Węzeł żądania *JScriptQuery. aspx* jest wyróżniony w edytorze. Rozwiń węzeł i zwróć uwagę, że część "1v0yhyiyr0raa2w4j4pwf5zl" CustomQueryString jest prawdopodobnie dynamiczna.

     ![Podejrzany parametr dynamiczny w CustomQueryString](../test/media/web_test_dynamicparameter_runresults2.png)

3. Wróć do przeglądarki Wyniki testów wydajności sieci Web i wybierz stronę *JScriptQuery. aspx* , która się nie powiodła. Następnie wybierz kartę żądanie, sprawdź, czy pole wyboru Pokaż nieprzetworzone dane jest wyczyszczone, przewiń w dół i wybierz pozycję Szybkie wyszukiwanie w CustomQueryString.

     ![Zrzut ekranu przedstawiający kartę żądanie w podglądzie wyników tekstu wydajności sieci Web. Wybrano parametr QueryString, a QuickFind jest wyróżniony w menu kontekstowym.](../test/media/web_test_dynamicparameter_runresultsquckfind.png)

4. Wiemy, że szukasz w edytorze testów, że CustomQueryString żądania *JScriptQuery. aspx* został przypisany do wartości: `jScriptQueryString___1v0yhyiyr0raa2w4j4pwf5zl` , a podejrzana część dynamiczna to "1v0yhyiyr0raa2w4j4pwf5zl". Na liście rozwijanej Znajdź, Usuń podejrzaną część ciągu wyszukiwania. Ciąg powinien mieć wartość "CustomQueryString = jScriptQueryString___".

     Do parametrów dynamicznych są przypisywane wartości w jednym z żądań poprzedzających żądanie, które zawiera błąd. W związku z tym zaznacz pole wyboru Przeszukaj w górę i wybierz pozycję Znajdź dalej do momentu wyświetlenia poprzedniego żądania *QueryString. aspx* wyróżnionego w panelu żądania. Powinno to nastąpić po trzykrotnym wybraniu pozycji Znajdź dalej.

     ![Zrzut ekranu przedstawiający Podgląd wyników w postaci tekstu wydajności sieci Web. Wybrano ciąg zapytania i zostanie wyświetlone okno dialogowe Znajdź z SearchUp i Znajdź następny.](../test/media/web_test_dynamicparameter_runresultsquckfind4.png)

     Jak pokazano na karcie odpowiedź i w języku JavaScript zaimplementowanym wcześniej pokazano poniżej, parametr ciągu zapytania CustomQueryString ma przypisaną wartość "jScriptQueryString___" i jest również łączona z wartością zwracaną z var sessionId.

    ```javascript
    function jScriptQueryString()          {             var Hidden = document.getElementById("HiddenFieldSessionID");             var sessionId = Hidden.value;             window.location = 'JScriptQuery.aspx?CustomQueryString=jScriptQueryString___' + sessionId;          }

    ```

     Teraz, gdy wiemy, gdzie występuje błąd, i musimy wyodrębnić wartość dla identyfikatora sesji. Jednakże wartość wyodrębniania jest tylko tekstem, więc musimy dalej wyizolować błąd, próbując zlokalizować ciąg, w którym wyświetlana jest rzeczywista wartość identyfikatora sesji. Patrząc na kod, można zobaczyć, że zmienna sessionId jest równa wartości zwróconej przez HiddenFieldSessionID.

5. Użyj opcji Szybkie wyszukiwanie w usłudze HiddenFieldSessionID, wyczyszczenie pola wyboru wyszukiwanie i wybór bieżącego żądania.

     ![Używanie szybkiego wyszukiwania na HiddenFieldSession](../test/media/web_test_dynamicparameter_runresultsquckfindhiddensession.png)

     Zwróć uwagę, że zwracana wartość nie jest tym samym ciągiem, co w oryginalnym rejestrowaniu testów wydajności sieci Web. Dla tego przebiegu testowego zwrócona wartość to "5w4v3yrse4wa4axrafykqksq", a w oryginalnym nagraniu wartością jest "1v0yhyiyr0raa2w4j4pwf5zl". Ponieważ wartość nie jest zgodna z oryginalnym nagrywaniem, zostanie wygenerowany błąd.

6. Ponieważ trzeba naprawić parametr dynamiczny w oryginalnym nagraniu, wybierz pozycję zarejestrowany wynik na pasku narzędzi.

     ![Wybierz zarejestrowany wynik](../test/media/web_test_dynamicparameter_recordedresult.png)

7. W zarejestrowanych wynikach wybierz trzecie żądanie, które jest tym samym żądaniem *Querystringrequest. aspx* , które zostało odizolowane w wynikach przebiegu testu.

     ![Wybierz to samo żądanie w zarejestrowanych wynikach](../test/media/web_test_dynamicparameter_recordedresultsselectnode.png)

     Wybierz kartę odpowiedź, przewiń w dół i wybierz oryginalną wartość parametru dynamicznego "1v0yhyiyr0raa2w4j4pwf5zl", która została wcześniej wyizolowana, a następnie Dodaj regułę wyodrębniania.

     ![Dodaj regułę wyodrębniania dla parametru dynamicznego](../test/media/web_test_dynamicparameter_recordedresultaddextractionrule.png)

     Nowa reguła wyodrębniania zostanie dodana do żądania *QueryString. aspx* i ma przypisaną wartość "Param0".

     Jeśli okno dialogowe informuje nas o znalezionych dopasowań dla wyodrębnionego tekstu, do którego ma zostać powiązany parametr, wybierz opcję **tak**.

     ![Utworzono regułę wyodrębniania](../test/media/web_test_dynamicparameter_addextractiondialog.png)

8. Wybierz pozycję **Znajdź dalej**. Pierwsze dopasowanie to ten, który należy zmienić, który jest parametrem CustomQueryString na stronie JScriptQuery.

     ![Znajdź i Zastąp tekst dla parametru](../test/media/web_test_dynamicparameter_addextractionfindreplace.png)

9. Wybierz **Zastąp**.

     ![Zastąp tekst parametrem](../test/media/web_test_dynamicparameter_addextractionfindreplace2.png)

     Parametr QueryString w żądaniu *JScriptQuery. aspx* został zaktualizowany przy użyciu nowego parametru kontekstu: CustomQueryString = jScriptQueryString___ {{Param0}}.

     ![Parametr zastosowany do QueryString](../test/media/web_test_dynamicparameter_addextractionfindreplace3.png)

10. Zamknij okno dialogowe **Znajdowanie i zamienianie** . Zauważ podobną strukturę w drzewie żądań między wykrytym parametrem dynamicznym i wykrytym dynamicznym parametrem, który został skorelowany.

     ![Wykryte i skorelowane parametry dynamiczne](../test/media/web_test_dynamicparameter_conclusion.png)

11. Uruchom test. Teraz działa bez błędów.

## <a name="qa"></a>Pytania i odpowiedzi

### <a name="q-can-i-re-run-dynamic-parameter-detection-if-my-web-app-gets-modified"></a>P: Czy można uruchomić ponowne wykrywanie parametrów dynamicznych, jeśli moja aplikacja sieci Web zostanie zmodyfikowana?

Odp **.:** Tak, użyj następującej procedury:

1. Na pasku narzędzi wybierz przycisk **Przekształć dynamiczne parametry na parametry testu sieci Web** .

     Po zakończeniu procesu wykrywania zostanie wyświetlone okno dialogowe **Podnieś parametry dynamiczne do parametrów testu sieci Web** , jeśli zostaną wykryte jakiekolwiek parametry dynamiczne.

     Parametry dynamiczne są wymienione w kolumnie parametry dynamiczne. Żądania, z których zostanie wyodrębniony parametr dynamiczny, i powiązane z nimi są wymienione w kolumnie Wyodrębnij parametr z odpowiedzi i powiąż z żądaniem.

     W przypadku wybrania parametru dynamicznego w oknie dialogowym **Awansuj parametry dynamiczne do parametrów testu sieci Web** w drzewie żądania Edytor internetowego testu wydajnościowego zostaną wyróżnione dwa żądania. Pierwsze żądanie będzie żądaniem dodania reguły wyodrębniania. Drugie żądanie polega na tym, że wyodrębniona wartość zostanie powiązana.

2. Zaznacz lub usuń zaznaczenie pola wyboru obok parametrów dynamicznych, które chcesz automatycznie skorelować. Domyślnie są sprawdzane wszystkie parametry dynamiczne.

### <a name="q-do-i-need-to-configure-visual-studio-to-detect-dynamic-parameters"></a>P: Czy muszę skonfigurować program Visual Studio do wykrywania parametrów dynamicznych?

Odp **.:** Domyślna konfiguracja programu Visual Studio wykrywa dynamiczne parametry podczas rejestrowania testu wydajności sieci Web. Jeśli jednak masz skonfigurowane opcje programu Visual Studio, aby nie wykrywać parametrów dynamicznych, lub testowana aplikacja sieci Web zostanie zmodyfikowana o dodatkowe parametry dynamiczne; można nadal uruchomić wykrywanie parametrów dynamicznych z Edytor internetowego testu wydajnościowego.
